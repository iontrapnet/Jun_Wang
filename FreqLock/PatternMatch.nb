(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27170,        806]
NotebookOptionsPosition[     25462,        750]
NotebookOutlinePosition[     25849,        767]
CellTagsIndexPosition[     25806,        764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"qA", " ", "=", " ", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"L", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"L", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722426085186172*^9, 3.7224260943449755`*^9}, {
  3.722564223731388*^9, 3.7225642239969606`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f2", " ", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "L"}], "/", "2"}], 
    RowBox[{"(", 
     RowBox[{"n2", "-", "1"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "f2"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7224262363305893`*^9, 3.7224262623589745`*^9}, {
  3.7224264123165197`*^9, 3.7224264717096176`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "z3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f3"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\:7b2c\:4e8c\:4e2a\:900f\:955c", " ", 
    RowBox[{"f3", ".", " ", "z3"}], " ", 
    "\:662f\:4ece\:7b2c\:4e8c\:4e2a\:900f\:955c\:5230\:7b2c\:4e00\:4e2a\:8154\
\:955c"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.722426536169113*^9, 3.7224265943626823`*^9}, {
  3.722428846487121*^9, 3.722428876170327*^9}, {3.7224289133051777`*^9, 
  3.722428920042162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"z4", "-", "z3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M4", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f4"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\:7b2c\:4e00\:4e2a\:900f\:955c", " ", 
    RowBox[{"f4", ".", " ", "z4"}], " ", 
    "\:662f\:4ece\:7b2c\:4e00\:4e2a\:900f\:955c\:5230\:7b2c\:4e00\:4e2a\:8154\
\:955c"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7224266200297685`*^9, 3.722426642947809*^9}, {
  3.722428903917877*^9, 3.7224289439667807`*^9}, {3.72251103057161*^9, 
  3.7225110659681015`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"M4", ".", "M3", ".", "M2", ".", "M1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7225644299958344`*^9, 3.7225644310442505`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q0", "=", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7224267090005746`*^9, 3.7224268105080357`*^9}, {
   3.7224274319141073`*^9, 3.722427433424012*^9}, 3.7225112428369308`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"q00", "=", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox["0.52", "2"]}], 
    RowBox[{"370", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n2", "=", "1.48"}], ";", 
   RowBox[{
   "(*", "\:5ffd\:7565\:7b2c\:4e00\:4e2a\:8154\:955c\:7684\:6298\:5c04\:4f5c\
\:7528", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Z", "=", "2000.0"}], ";"}], 
  RowBox[{
  "(*", "\:4ece\:6fc0\:5149\:675f\:8170\:5230\:7b2c\:4e00\:4e2a\:8154\:955c", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", "=", "75.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f4", "=", "100.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z3", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z4", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z5", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z6", ",", "Reals"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQzSK5dtr33a8dZXhmTwfRaj8/zwXRH9YorwPR81bP
3QWiz/Hm7AbRvt1XnX8A6dsXD7iBaOf+zQEgunSLURCI1jdbXaSwB6j/cFop
iH5oq//YfN9rxwCLEjDdmZL/HESLPykB0zedUmUtgLRT3D4wneR+QhlER2Vq
qYPoA7O+aIHoCdaHtUH0wWufLUD0tseCliBaa/M6HxBta3wCTIuxpQeC6L62
bDB9Y9vHcBCde0wgAkR/sDweB6JfHH0Kpk/mOmSB6P7/c8F0hvVRsxsHXjvy
7b4CptNVF9qC6MRDZg4gOu7p5iM3gfT9pyfA9JPpc06CaLOMQ2A6tSar8BaQ
3vHauwREJwneXQ2iD4kzrgHRAEAVz9w=
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z4", ">", "z3", ">", "0"}]}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z4", ">", "z3", ">", "0"}]}], "]"}], "\[Equal]", "q00"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z3", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "160"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7225644569139423`*^9, 3.7225644766521173`*^9}, {
  3.7236078743879533`*^9, 3.7236078782019987`*^9}, {3.723608305981475*^9, 
  3.723608340264518*^9}, {3.7236084228014317`*^9, 3.723608428890643*^9}, {
  3.7236086153536615`*^9, 3.723608616300784*^9}, {3.7236087750191402`*^9, 
  3.723608775831008*^9}, {3.7236088351863456`*^9, 3.723608863187705*^9}, {
  3.7236090686748905`*^9, 3.723609092298918*^9}, {3.7249879522651176`*^9, 
  3.7249879584434156`*^9}, {3.724989357968487*^9, 3.7249893623913836`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z3", "\[Rule]", "229.83945182382828`"}], ",", 
   RowBox[{"z4", "\[Rule]", "424.03439556692547`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7225644778698006`*^9, {3.7236078293230667`*^9, 3.723607878853449*^9}, {
   3.723608313595004*^9, 3.7236083789626675`*^9}, {3.7236084097716885`*^9, 
   3.7236084298108344`*^9}, 3.7236085233746176`*^9, 3.723608617410113*^9, 
   3.723608680649725*^9, {3.7236087722265015`*^9, 3.7236087763654547`*^9}, {
   3.723608825019346*^9, 3.7236088637197876`*^9}, 3.7236089190419445`*^9, {
   3.723609074351824*^9, 3.723609092861452*^9}, 3.724984765631287*^9, {
   3.724984817628395*^9, 3.7249848357277*^9}, {3.724987945544816*^9, 
   3.7249879842163773`*^9}, {3.724989328359831*^9, 3.7249893628444805`*^9}, 
   3.724989793862611*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"z4", "-", "z3"}], ")"}], "/.", "%88"}]], "Input",
 CellChangeTimes->{{3.7249919018350744`*^9, 3.7249919218688035`*^9}}],

Cell[BoxData["194.19494374309718`"], "Output",
 CellChangeTimes->{{3.724991917773942*^9, 3.7249919222750635`*^9}}]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[BoxData[
 RowBox[{"(*", "\:9700\:8981\:63d0\:9ad8z3\:9c81\:68d2\:6027", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7225648201853185`*^9, 3.7225648273496346`*^9}, {
  3.722564857776974*^9, 3.722564867577817*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"L", ",", "n2", ",", "Z", ",", "f3", ",", "f4"}], "]"}]], "Input",
 CellChangeTimes->{{3.7225647879546585`*^9, 3.722564809297456*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M5", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"z5", "-", "z4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M5", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f3"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M5"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7225108304880238`*^9, 3.7225108599361763`*^9}, {
  3.7225109463124547`*^9, 3.722510962522767*^9}, {3.7225110365825877`*^9, 
  3.7225110371450987`*^9}, {3.722511417406044*^9, 3.7225114191565495`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M6", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"z6", "-", "z5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M6", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f3"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M6"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722510983232586*^9, 3.7225110479166017`*^9}, {
  3.7225114216000824`*^9, 3.722511421725085*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M7", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Z", "-", "z6"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72242688652428*^9, 3.72242689150976*^9}, {
  3.722427208027606*^9, 3.722427217860649*^9}, {3.7225110553187375`*^9, 
  3.7225110554124928`*^9}, {3.722511213707803*^9, 3.7225112165501943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{
   "M7", ".", "M6", ".", "M5", ".", "M4", ".", "M3", ".", "M2", ".", "M1"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7224266842555385`*^9, 3.72242668992022*^9}, {
   3.7224267446597877`*^9, 3.7224267495361576`*^9}, {3.7224272236755266`*^9, 
   3.7224272257387*^9}, 3.722427835650558*^9, {3.722511221567763*^9, 
   3.7225112255530105`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q0", "=", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7224267090005746`*^9, 3.7224268105080357`*^9}, {
   3.7224274319141073`*^9, 3.722427433424012*^9}, 3.7225112428369308`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"q00", "=", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox["0.52", "2"]}], 
    RowBox[{"370", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n2", "=", "1"}], ";"}], 
  RowBox[{
  "(*", "\:5ffd\:7565\:7b2c\:4e00\:4e2a\:8154\:955c\:7684\:6298\:5c04\:4f5c\
\:7528", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "=", "2000.0"}], ";"}], 
  RowBox[{
  "(*", "\:4ece\:6fc0\:5149\:675f\:8170\:5230\:7b2c\:4e00\:4e2a\:8154\:955c", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", "=", "200.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f4", "=", "100.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z3", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z4", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z5", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z6", ",", "Reals"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7224275734093037`*^9, 3.722427580845228*^9}, {
  3.7224276316241636`*^9, 3.7224277611148605`*^9}, {3.7224278609271994`*^9, 
  3.722427867376685*^9}, {3.7224289586732545`*^9, 3.722428982025617*^9}, {
  3.722429061611238*^9, 3.7224290735845284`*^9}, {3.722511253350364*^9, 
  3.722511275211418*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z6", ">", "z5", ">", "z4", ">", "z3", ">", "0"}]}], "]"}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z6", ">", "z5", ">", "z4", ">", "z3", ">", "0"}]}], "]"}], 
      "\[Equal]", "q00"}], ",", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"ComplexExpand", "[", 
          RowBox[{"D", "[", 
           RowBox[{"q0", ",", "z3"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"z6", ">", "z5", ">", "z4", ">", "z3", ">", "0"}]}], "]"}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{"ComplexExpand", "[", 
          RowBox[{"D", "[", 
           RowBox[{"q0", ",", "z3"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"z6", ">", "z5", ">", "z4", ">", "z3", ">", "0"}]}], "]"}], 
      "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z3", ",", "500"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "1000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z5", ",", "1500"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z6", ",", "1800"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7224277839821873`*^9, 3.722427799360241*^9}, {
  3.7224278436988583`*^9, 3.722427845465027*^9}, {3.7224278771114283`*^9, 
  3.722427883059986*^9}, {3.722428451357913*^9, 3.722428468744632*^9}, {
  3.722428527079666*^9, 3.7224285300282145`*^9}, {3.72242856988381*^9, 
  3.722428603021214*^9}, {3.7224286469425344`*^9, 3.7224286764302053`*^9}, {
  3.7224287596180277`*^9, 3.722428807967923*^9}, {3.7225113046494465`*^9, 
  3.722511305368266*^9}, {3.7225114487183905`*^9, 3.7225114786661015`*^9}, {
  3.7225115394309654`*^9, 3.7225115943252907`*^9}, {3.7225116475820165`*^9, 
  3.7225116933402987`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "FindRoot","lstol",
   "\"\:7ebf\:641c\:7d22\:628a\:6b65\:957f\:964d\:4f4e\:5230\:7531 \
AccuracyGoal \:548c PrecisionGoal \:6307\:5b9a\:7684\:5bb9\:5dee\:8303\:56f4\
\:5185\:ff0c\:4f46\:662f\:65e0\:6cd5\:627e\:5230 merit \:51fd\:6570\:7684\
\:5145\:8db3\:7684\:964d\:4f4e. \:60a8\:53ef\:80fd\:9700\:8981\:591a\:4e8e \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) \:4f4d\:5de5\:4f5c\:7cbe\:5ea6\
\:4ee5\:6ee1\:8db3\:8fd9\:4e9b\:5bb9\:5dee.\"",2,52,1,28840191265570705439,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7225146271717043`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z3", "\[Rule]", "574.1730780809912`"}], ",", 
   RowBox[{"z4", "\[Rule]", "1092.3165808467147`"}], ",", 
   RowBox[{"z5", "\[Rule]", "1436.1263781255425`"}], ",", 
   RowBox[{"z6", "\[Rule]", "1765.4212355308166`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7224277903527117`*^9, {3.722427845777528*^9, 3.7224278835599394`*^9}, 
   3.72242847048114*^9, 3.722428530810185*^9, 3.7224286781811275`*^9, {
   3.7224287927030773`*^9, 3.7224288085303745`*^9}, 3.72251163810415*^9, 
   3.7225146278443832`*^9}]
}, Open  ]],

Cell["", "PageBreak",
 PageBreakBelow->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qA", " ", "=", " ", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"L", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"L", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722426085186172*^9, 3.7224260943449755`*^9}, {
  3.722564223731388*^9, 3.7225642239969606`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"f2", " ", "=", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "L"}], "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"n2", "-", "1"}], ")"}]]}], ";", "\[IndentingNewLine]", 
   RowBox[{"M2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f2"}], ",", "1"}], "}"}]}], "}"}]}], ";"}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.7224262363305893`*^9, 3.7224262623589745`*^9}, {
  3.7224264123165197`*^9, 3.7224264717096176`*^9}, {3.725240666753133*^9, 
  3.7252406728324537`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "z3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f3"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\:7b2c\:4e8c\:4e2a\:900f\:955c", " ", 
    RowBox[{"f3", ".", " ", "z3"}], " ", 
    "\:662f\:4ece\:7b2c\:4e8c\:4e2a\:900f\:955c\:5230\:7b2c\:4e00\:4e2a\:8154\
\:955c"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.722426536169113*^9, 3.7224265943626823`*^9}, {
  3.722428846487121*^9, 3.722428876170327*^9}, {3.7224289133051777`*^9, 
  3.722428920042162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"z4", "-", "z3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M4", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f4"}], ",", "1"}], "}"}]}], "}"}], ".", 
    "M4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\:7b2c\:4e00\:4e2a\:900f\:955c", " ", 
    RowBox[{"f4", ".", " ", "z4"}], " ", 
    "\:662f\:4ece\:7b2c\:4e00\:4e2a\:900f\:955c\:5230\:7b2c\:4e00\:4e2a\:8154\
\:955c"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7224266200297685`*^9, 3.722426642947809*^9}, {
  3.722428903917877*^9, 3.7224289439667807`*^9}, {3.72251103057161*^9, 
  3.7225110659681015`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"M4", ".", "M3", ".", "M1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7225644299958344`*^9, 3.7225644310442505`*^9}, 
   3.7252406977621756`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q0", "=", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
     RowBox[{
      RowBox[{"qA", " ", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7224267090005746`*^9, 3.7224268105080357`*^9}, {
   3.7224274319141073`*^9, 3.722427433424012*^9}, 3.7225112428369308`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"q00", "=", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox["0.52", "2"]}], 
    RowBox[{"370", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "=", "2000.0"}], ";"}], 
  RowBox[{
  "(*", "\:4ece\:6fc0\:5149\:675f\:8170\:5230\:7b2c\:4e00\:4e2a\:8154\:955c", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", "=", "50.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f4", "=", "100.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z3", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z4", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z5", ",", "Reals"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Element", "[", 
   RowBox[{"z6", ",", "Reals"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQzSK5dtr33a8dZXhmTwfRaj8/zwXRH9YorwPR81bP
3QWiz/Hm7AbRvt1XnX8A6dsXD7iBaOf+zQEgunSLURCI1jdbXaSwB6j/cFop
iH5oq//YfN9rxwCLEjDdmZL/HESLPykB0zedUmUtgLRT3D4wneR+QhlER2Vq
qYPoA7O+aIHoCdaHtUH0wWufLUD0tseCliBaa/M6HxBta3wCTIuxpQeC6L62
bDB9Y9vHcBCde0wgAkR/sDweB6JfHH0Kpk/mOmSB6P7/c8F0hvVRsxsHXjvy
7b4CptNVF9qC6MRDZg4gOu7p5iM3gfT9pyfA9JPpc06CaLOMQ2A6tSar8BaQ
3vHauwREJwneXQ2iD4kzrgHR/S/SjEMPvnY81lQKpndVzA4H0W9O7QPTAGI6
4dU=
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z4", ">", "z3", ">", "0"}]}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{"ComplexExpand", "[", "q0", "]"}], "]"}], ",", 
        RowBox[{"z4", ">", "z3", ">", "0"}]}], "]"}], "\[Equal]", "q00"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z3", ",", "200"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "350"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7225644569139423`*^9, 3.7225644766521173`*^9}, {
  3.7236078743879533`*^9, 3.7236078782019987`*^9}, {3.723608305981475*^9, 
  3.723608340264518*^9}, {3.7236084228014317`*^9, 3.723608428890643*^9}, {
  3.7236086153536615`*^9, 3.723608616300784*^9}, {3.7236087750191402`*^9, 
  3.723608775831008*^9}, {3.7236088351863456`*^9, 3.723608863187705*^9}, {
  3.7236090686748905`*^9, 3.723609092298918*^9}, {3.7249879522651176`*^9, 
  3.7249879584434156`*^9}, {3.724989357968487*^9, 3.7249893623913836`*^9}, {
  3.7252407455240755`*^9, 3.7252407698743305`*^9}, {3.7252410265355234`*^9, 
  3.725241029341508*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z3", "\[Rule]", "152.50733499801748`"}], ",", 
   RowBox[{"z4", "\[Rule]", "309.6361927541686`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7225644778698006`*^9, {3.7236078293230667`*^9, 3.723607878853449*^9}, {
   3.723608313595004*^9, 3.7236083789626675`*^9}, {3.7236084097716885`*^9, 
   3.7236084298108344`*^9}, 3.7236085233746176`*^9, 3.723608617410113*^9, 
   3.723608680649725*^9, {3.7236087722265015`*^9, 3.7236087763654547`*^9}, {
   3.723608825019346*^9, 3.7236088637197876`*^9}, 3.7236089190419445`*^9, {
   3.723609074351824*^9, 3.723609092861452*^9}, 3.724984765631287*^9, {
   3.724984817628395*^9, 3.7249848357277*^9}, {3.724987945544816*^9, 
   3.7249879842163773`*^9}, {3.724989328359831*^9, 3.7249893628444805`*^9}, 
   3.724989793862611*^9, {3.7252407412050095`*^9, 3.725240770472756*^9}, {
   3.7252410238296013`*^9, 3.7252410298718834`*^9}}]
}, Open  ]]
},
WindowSize->{759, 601},
WindowMargins->{{218, Automatic}, {Automatic, 44}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (2016\:5e7410\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 512, 15, 62, "Input"],
Cell[1073, 37, 598, 20, 87, "Input"],
Cell[1674, 59, 953, 29, 86, "Input"],
Cell[2630, 90, 983, 30, 86, "Input"],
Cell[3616, 122, 185, 4, 37, "Input"],
Cell[3804, 128, 743, 22, 60, "Input"],
Cell[4550, 152, 1676, 45, 280, "Input"],
Cell[CellGroupData[{
Cell[6251, 201, 1266, 30, 86, "Input"],
Cell[7520, 233, 816, 14, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8373, 252, 171, 4, 37, "Input"],
Cell[8547, 258, 114, 1, 37, "Output"]
}, Open  ]],
Cell[8676, 262, 273, 9, 7, "Text"],
Cell[8952, 273, 216, 4, 37, "Input"],
Cell[9171, 279, 182, 3, 37, "Input"],
Cell[9356, 284, 792, 24, 62, "Input"],
Cell[10151, 310, 689, 23, 62, "Input"],
Cell[10843, 335, 466, 12, 37, "Input"],
Cell[11312, 349, 400, 9, 37, "Input"],
Cell[11715, 360, 743, 22, 60, "Input"],
Cell[12461, 384, 1575, 43, 280, "Input"],
Cell[CellGroupData[{
Cell[14061, 431, 2216, 55, 134, "Input"],
Cell[16280, 488, 602, 11, 53, "Message"],
Cell[16885, 501, 557, 11, 37, "Output"]
}, Open  ]],
Cell[17457, 515, 44, 1, 1, "PageBreak",
 PageBreakBelow->True],
Cell[17504, 518, 512, 15, 62, "Input"],
Cell[18019, 535, 675, 21, 72, "Input"],
Cell[18697, 558, 953, 29, 86, "Input"],
Cell[19653, 589, 983, 30, 86, "Input"],
Cell[20639, 621, 202, 5, 37, "Input"],
Cell[20844, 628, 743, 22, 60, "Input"],
Cell[21590, 652, 1540, 42, 256, "Input"],
Cell[CellGroupData[{
Cell[23155, 698, 1371, 32, 86, "Input"],
Cell[24529, 732, 917, 15, 37, "Output"]
}, Open  ]]
}
]
*)

